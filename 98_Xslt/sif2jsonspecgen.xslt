<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:json="http://json.org/">
  <!-- from https://gist.github.com/inancgumus/3ce56ddde6d5c93f3550b3b4cdc6bcb8 -->
  <!-- https://github.com/bramstein/xsltjson/blob/master/conf/xml-to-jsonml.xsl -->
  <xsl:output method="text" omit-xml-declaration="yes" encoding="utf-8"/>

  <xsl:template match="/*[node()]">
    <xsl:apply-templates select="." mode="obj-list" />
  </xsl:template>

  <xsl:template match="*" mode="detect">
    <xsl:choose>
      <xsl:when test="count(./child::*) > 0 or count(@*) > 0">
        <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="obj-content" />
      </xsl:when>
      <xsl:when test="count(./child::*) = 0">
        <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="value"/>
      </xsl:when>
    </xsl:choose>
    <xsl:if test="count(following-sibling::*) &gt; 0">, </xsl:if>
  </xsl:template>

  <xsl:template match="*" mode="value">
    <xsl:text>"</xsl:text><xsl:apply-templates select="."/><xsl:text>"</xsl:text>
  </xsl:template>

  <xsl:template match="*" mode="obj-detect">
    {
    <xsl:choose>
      <xsl:when test="count(./child::*) > 0 or count(@*) > 0">
        <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="obj-content" />
      </xsl:when>
      <xsl:when test="count(./child::*) = 0">
        <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="value"/>
      </xsl:when>
    </xsl:choose>
    }
  </xsl:template>

  <!-- objects -->
  <xsl:template match="Address | StudentProgramAssociation | xCalendar | xContact | xCourse | xIndividualizedEducationPlan | xLea | xRoster | xSchool | xStaff | xStudent | xTransferIEP | AccountingPeriod | Activity | ActivityProvider | AggregateCharacteristicInfo | AggregateStatisticFact | AggregateStatisticInfo | Assessment | AssessmentAdministration | AssessmentForm | AssessmentItem | AssessmentPackage | AssessmentRegistration | AssessmentSubTest | Assignment | AttendanceCodeInfo | Authentication | BellSchedule | Billing | BusEquipment | BusInfo | BusPositionInfo | BusRouteDetail | BusRouteInfo | BusStopInfo | CalendarDate | CalendarSummary | ContentCatalog | CurriculumStructure | DisciplineIncident | EmployeeAssignment | EmployeeContract | EmployeeCredential | EmployeeCredit | EmployeePersonal | EmployeePicture | EmployeeRecertification | EmployeeWage | EmploymentRecord | EnergyUsage | FinancialAccount | FinancialAccountAccountingPeriodLocationInfo | FinancialAnnual | FinancialBudget | FinancialClass | FinancialIncomeStatement | FinancialTransaction | FiscalYear | FoodserviceItem | FoodserviceItemPortion | FoodserviceItemSales | FoodserviceItemUnit | FoodserviceMealPrices | FoodserviceMenuPlan | FoodserviceMilkSales | FoodservicePurchaseTransaction | FoodserviceReimbursementRates | FoodserviceSales | FoodserviceStaffEnrollmentCount | FoodserviceStaffMealCounts | FoodserviceStudentEnrollmentCount | FoodserviceStudentMealCounts | FoodserviceTransaction | FoodserviceTransactionDetails | FoodserviceTransactionPayMethod | GradingAssignment | GradingAssignmentScore | GradingCategory | IdMApplication | IdMAuthentication | IdMAuthorization | ItemCharacteristics | LEAInfo | LearningResource | LearningResourcePackage | LearningStandardAssociation | LearningStandardDocument | LearningStandardItem | Lesson | LibraryPatronStatus | LocationInfo | MarkInfo | MarkValueInfo | OfficialStudentPeriodAttendance | Payment | PersonRoleAssociation | ProfessionalDevelopmentActivities | ProfessionalDevelopmentProgram | ProfessionalDevelopmentRegistration | Purchasing | RTIResults | ReportAuthorityInfo | ReportManifest | ResponseToIntervention | RoomInfo | RoomType | SEAInfo | SIF_ReportObject | SchoolCourseInfo | SchoolInfo | SectionCorrelation | SectionInfo | SectionMarkInfo | StaffAssignment | StaffEvaluation | StaffMeal | StaffPersonal | StaffSectionAssignment | StudentAcademicRecord | StudentActivityInfo | StudentActivityParticipation | StudentAttendanceSummary | StudentContact | StudentContactPersonal | StudentContactRelationship | StudentDailyAttendance | StudentDemographicRecord | StudentGrade | StudentLEARelationship | trueStudentLocator | StudentMeal | StudentParticipation | StudentPeriodAttendance | StudentPersonal | StudentPicture | StudentPlacement | StudentRecordExchange | StudentRecordPackage | StudentResponseSet | StudentSchoolEnrollment | StudentScoreSet | StudentSectionEnrollment | StudentSectionMarks | StudentSnapshot | StudentSpecialEducationRecord | StudentSpecialEducationSummary | StudentTransportInfo | TermInfo | TestAccommodation | TimeWorked | UserOrganizationAssociation | VendorInfo | W4" mode="obj-list">
    <xsl:if test="count(preceding-sibling::*) = 0">
      <xsl:text>[</xsl:text>
    </xsl:if>
    <xsl:choose>
      <xsl:when test="count(./child::*) > 0 or count(@*) > 0">
        <xsl:apply-templates select="." mode="obj-detect" />
      </xsl:when>
    </xsl:choose>
    <xsl:if test="count(following-sibling::*) &gt; 0">, </xsl:if>
    <xsl:if test="count(following-sibling::*) = 0"><xsl:text>]</xsl:text></xsl:if>
  </xsl:template>

  <!-- numeric or boolean -->
  <xsl:template match="/GridLocation/Latitude | /GridLocation/Longitude | /relationship/contactSequence | /metric/accuracyPercentEvaluation | /trialCountEvaluation/successCount | /trialCountEvaluation/attemptCount | /cycle/count | /duration/directMinutes | /duration/indirectMinutes | /dataValue/category | /dataValue/value | /leastRestrictiveEnvironment/totalMinutesPerWeek | /leastRestrictiveEnvironment/inclusionMinutesPerWeek | /leastRestrictiveEnvironment/nonInclusionMinutesPerWeek | /primaryStaff/percentResponsible | /academicSummary/cumulativeWeightedGpa | /academicSummary/termWeightedGpa | /academicSummary/classRank | /FeeForUse/PerUseCharge | Activity/Points | /ActivityTime/Duration | Activity/MaxAttemptsAllowed | Activity/ActivityWeight | AggregateStatisticFact/Value | /Race/Proportion | AssessmentSubTest/SubTestTier | AssessmentSubTest/NumberOfItems | /AssignmentTime/Duration | Assignment/MaxAttemptsAllowed | AttendanceCodeInfo/AbsenceValue | /BellPeriod/InstructionalMinutes | Billing/BilledAmount | BusInfo/SeatingCapacity | /Equipment/Count | BusPositionInfo/Odometer | BusPositionInfo/Speedometer | BusRouteInfo/MaximumLoad | BusRouteInfo/RouteDistanceLoaded | BusRouteInfo/RouteDistanceTotal | CalendarDate/CalendarDateNumber | /StudentAttendance/AttendanceValue | /TeacherAttendance/AttendanceValue | /AdministratorAttendance/AttendanceValue | CalendarSummary/DaysInSession | CalendarSummary/InstructionalMinutes | CalendarSummary/MinutesPerDay | ContentCatalog/Duration | ContentCatalog/Cost | /CurriculumHierarchyLevel/Number | /Action/Duration | /IncidentAction/Duration | EmployeeAssignment/JobFTE | EmployeeContract/BaseSalary | EmployeeContract/ContractDays | EmployeeContract/AssignmentDays | EmployeeCredential/Salary | EmployeeCredential/TotalYears | EmployeeCredential/UnitYears | /Assignment/FTE | EmployeeCredit/Earned | EmployeeRecertification/ActivityHours | EmployeeRecertification/Earned | /PayRate/Amount | /PayRate/Percentage | EmploymentRecord/TotalYearsExperience | /ReadingData/Interval | /ReadingList/Reading | /AnnualItem/Amount | /BudgetAccount/BudgetAmount | FoodserviceItemPortion/ItemPortionQuantity | /ItemQuantity/Value | /ItemQuantity/Cost | FoodserviceItemUnit/GramWeight | /Price/Value | /MenuPlanQuantities/MenuPlanQuantity | /SaleQuantity/Value | /SaleQuantity/ChargeToChild | /PurchaseQuantity/Value | /Rate/Value | /Count/Tax | /Count/Value | FoodserviceTransaction/Tax | GradingAssignment/PointsPossible | GradingAssignment/Weight | GradingAssignmentScore/ScorePoints | GradingAssignmentScore/ScorePercent | ItemCharacteristics/PercentCorrect | ItemCharacteristics/SampleSize | /Descriptive/SampleSize | /Descriptive/PointBiserial | /Descriptive/Biserial | /Descriptive/DiscriminationIndex | /DifferentialItemAnalysis/CMH | /DifferentialItemAnalysis/MH | /Choice/Responses | /TargetObject/AssociationStrength | /StandardHierarchyLevel/Number | Lesson/Duration | /ItemInfo/Price | /FineInfo/Amount | LibraryPatronStatus/NumberOfCheckouts | LibraryPatronStatus/NumberOfOverdues | LibraryPatronStatus/NumberOfFines | LibraryPatronStatus/FineAmount | LibraryPatronStatus/NumberOfRefunds | LibraryPatronStatus/RefundAmount | /Percentage/Minimum | /Percentage/Maximum | /Numeric/Precision | /Numeric/Scale | /Numeric/Low | /Numeric/High | /ValidMark/NumericEquivalent | /Narrative/MaximumSize | Payment/ReceivedAmount | ProfessionalDevelopmentActivities/ClockHours | ProfessionalDevelopmentActivities/Credits | ProfessionalDevelopmentActivities/Stipend | ProfessionalDevelopmentRegistration/PaidAmount | ProfessionalDevelopmentRegistration/Stipend | /PurchasingItem/UnitCost | /ExpenseAccount/Amount | ReportManifest/SIF_MaxBufferSize | ResponseToIntervention/Tier | /FrequencyTime/Duration | RoomInfo/Size | RoomInfo/Capacity | /ReportInfo/SubmissionNumber | SchoolCourseInfo/CourseCredits | /SCEDCode/AvailableCredit | /SCEDCode/SequenceNumber | /SCEDCode/SequenceLimit | /SchoolCourseInfoOverride/CourseCredits | StaffAssignment/JobFTE | StaffSectionAssignment/PercentResponsible | /MarkData/Percentage | /MarkData/Numeric | /MarkData/NumericAsDecimal | /MarkingPeriod/CourseCreditsAttempted | /MarkingPeriod/CourseCreditsEarned | /MarkingPeriod/DaysAbsent | /MarkingPeriod/DaysPresent | /TermPerformance/CreditsAttempted | /TermPerformance/CreditsEarned | /TermPerformance/GPACreditsAttempted | /TermPerformance/GPACreditsEarned | /TermPerformance/GPAGradePoints | /TermPerformance/GPA | /TermPerformance/WeightedGPA | /TermPerformance/DaysAbsent | /TermPerformance/DaysPresent | /AcademicPerformanceSummary/TotalCreditsAttempted | /AcademicPerformanceSummary/TotalCreditsEarned | /AcademicPerformanceSummary/CumulativeGPACreditsEarned | /AcademicPerformanceSummary/CumulativeGradePoints | /AcademicPerformanceSummary/CumulativeGPA | /AcademicPerformanceSummary/ClassRank | /AcademicPerformanceSummary/ClassTotalNumber | StudentAttendanceSummary/StartDay | StudentAttendanceSummary/EndDay | StudentAttendanceSummary/FTE | StudentAttendanceSummary/DaysAttended | StudentAttendanceSummary/ExcusedAbsences | StudentAttendanceSummary/UnexcusedAbsences | StudentAttendanceSummary/DaysTardy | StudentAttendanceSummary/DaysInMembership | StudentContact/ContactSequence | StudentContactRelationship/ContactSequence | /Grade/Percentage | /Grade/Numeric | /Grade/OutOf | /Grade/Low | /Grade/High | StudentParticipation/StudentSpecialEducationFTE | StudentPlacement/DirectTime | StudentPlacement/IndirectTime | StudentPlacement/TotalServiceDuration | /Item/NumberOfAttempts | StudentSchoolEnrollment/FTE | /Score/NumberOfResponses | StudentSectionEnrollment/CreditsAttempted | /Mark/Percentage | /Mark/Numeric | StudentSnapshot/Age | /StudentParticipationData/StudentSpecialEducationFTE | /StudentParticipationData/DaysInParticipation | StudentSpecialEducationSummary/StudentSpecialEducationFTE | /NeglectedOrDelinquentParticipation/TotalDayCount | /NeglectedOrDelinquentParticipation/ConsecutiveDayCount | StudentTransportInfo/HomeToSchoolDistance | StudentTransportInfo/WalkToStopDistance | StudentTransportInfo/StopToSchoolDistance | TermInfo/RelativeDuration | TimeWorked/RegularHours | TimeWorked/OvertimeHours | W4/FederalAllowancesNumber | W4/StateAllowancesNumber | /sessionList/markingTerm | /sessionList/schedulingTerm | /phoneNumber/primaryIndicator | /relationship/livesWith | /relationship/primaryContactIndicator | /relationship/emergencyContactIndicator | /relationship/financialResponsibilityIndicator | /relationship/custodialIndicator | /relationship/communicationsIndicator | /costSharing/status | /decisions/severeDiscrepancyFound | /decisions/InsufficientResponseToInterventionFound | /decisions/eligibleForSpecificLearningDisabilityFinding | /decisions/specificDisabilityIdentified | /primaryStaff/teacherOfRecord | /demographics/hispanicLatinoEthnicity | /phone/primaryIndicator | /TimeElement/IsCurrent | /RightsElement/Cost | AssessmentSubTest/ContainerOnly | Assignment/AddToGradeBookFlag | EmploymentRecord/Active | /LEARelationshipType/ProvidingInstruction | /LEARelationshipType/ProvidingServices | /LEARelationshipType/FinanciallyResponsible | /SchoolCourseInfoData/CoreAcademicCourse | /MarkingPeriod/ExcessiveAbsenceIndicator | StudentParticipation/ExtendedSchoolYear | StudentParticipation/ExtendedDay | StudentParticipation/PrivateNotPlacedByPublic | StudentPlacement/IncludedInSpecialEducationFTE | StudentPlacement/SpecialNeedsTransportation | StudentPlacement/AssistiveTechnology | StudentSectionMarks/IsFinal | /Accommodation/SpecialMaterials | VendorInfo/Send1099 | W4/Exempt" mode="value">
    <xsl:apply-templates select="."/>
  </xsl:template>

  <xsl:template match="* | @*" mode="attrvalue">
    <xsl:text>"</xsl:text><xsl:apply-templates select="."/><xsl:text>"</xsl:text>
  </xsl:template>

  <!-- numeric or boolean attribute -->
  <xsl:template match="NEVERMATCH | NEVERMATCH" mode="attrvalue">
    <xsl:apply-templates select="."/>
  </xsl:template>

  <!-- simple content with attribute -->
  <xsl:template match="Address/AddressType | /LocalId/IdType | Address/Subregion | Address/StateProvince | Address/Country | StudentProgramAssociation/EntryType | StudentProgramAssociation/YearGroup | StudentProgramAssociation/ExitStatus | StudentProgramAssociation/ExitType | StudentProgramAssociation/PlacementType | /ManagingSchoolLocalId/IdType | /FeeForUse/PerUseCharge | /GradeLevel/Code | /OtherCodeList/OtherCode | /SubjectArea/Code | /InterestLevel/Code | /BloomsTaxonomyLevels/BloomsTaxonomyLevel | /MultipleIntelligences/MultipleIntelligence | /InstructionalStrategies/InstructionalStrategy | /ResourceTypes/ResourceType | /SIF_ExtendedElements/SIF_ExtendedElement | /SourceObjects/SourceObject | /ActivityTime/Duration | /Address/StateProvince | /Address/Country | AggregateStatisticFact/Excluded | AggregateStatisticInfo/CalculationRule | /ExclusionRules/ExclusionRule | /Location/LocationRefId | AggregateStatisticInfo/Measure | /AssessmentDescriptors/AssessmentDescriptor | /SpecialConditions/SpecialCondition | AssessmentForm/AssessmentType | /Stimulus/XMLData | /Stimulus/TextData | /Stimulus/BinaryData | /Stem/XMLData | /Stem/TextData | /Stem/BinaryData | /ChoiceContent/XMLData | /ChoiceContent/TextData | /ChoiceContent/BinaryData | AssessmentPackage/XMLData | /StudentSpecialConditions/StudentSpecialCondition | /StudentGradeLevel/Code | /AssessmentGradeLevel/Code | /Race/Code | /AssessmentStudentSnapshot/HispanicLatino | /AssessmentStudentSnapshot/Gender | /AssessmentStudentSnapshot/Title1 | /AssessmentStudentSnapshot/ELL | /AssignmentTime/Duration | AttendanceCodeInfo/AttendanceType | AttendanceCodeInfo/AttendanceStatus | AttendanceCodeInfo/UsedForDailyAttendance | AttendanceCodeInfo/UsedForPeriodAttendance | /AuthenticationInfo/System | /PasswordList/Password | /BellPeriod/RegularSchoolPeriod | /BellPeriod/UseInAttendanceCalculations | Billing/BilledEntity | Billing/BilledAmount | /BusDriver/Status | /BusStaff/Status | BusPositionInfo/Odometer | BusPositionInfo/Speedometer | /Student/Status | BusRouteInfo/RouteType | BusRouteInfo/RouteDistanceLoaded | BusRouteInfo/RouteDistanceTotal | /CalendarDateType/Code | /StudentAttendance/CountsTowardAttendance | /TeacherAttendance/CountsTowardAttendance | /AdministratorAttendance/CountsTowardAttendance | /ContentObject/SourceObject | /ContentObject/Location | ContentCatalog/LanguageCode | /StandardsSettingBody/Country | /StandardsSettingBody/StateProvince | ContentCatalog/InstructionalLevel | ContentCatalog/Duration | ContentCatalog/Cost | /ComponentObjects/ComponentObject | DisciplineIncident/AgencyReporting | DisciplineIncident/IncidentTime | DisciplineIncident/IncidentLocation | DisciplineIncident/IncidentLocationRefId | /IncidentReporter/SIF_RefId | /RelatedToList/RelatedTo | /WeaponTypeList/WeaponType | /IncidentCategory/Code | /Offender/SIF_RefId | /Offender/Injury | /ManifestationDetermination/MeetingHeld | /ManifestationDetermination/DueToDisability | /Action/Code | /Action/ZeroTolerance | /Action/FullYearExpulsion | /Action/ShortenedExpulsion | /Action/PoliceNotification | /Action/Arrest | /Action/AlternativeEducation | /Victim/SIF_RefId | /Victim/Injury | /IncidentAction/ZeroTolerance | /IncidentAction/PoliceNotification | /IncidentAction/Arrest | EmployeeAssignment/PrimaryAssignment | /JobClassification/Code | /ProgramType/Code | /FundingSource/Code | EmployeeContract/BaseSalary | EmployeeContract/ContractTerm | /Demographics/HispanicLatino | /Demographics/Gender | /Demographics/BirthDateVerification | /Demographics/StateOfBirth | /Demographics/CountryOfBirth | /CountriesOfCitizenship/CountryOfCitizenship | /CountriesOfResidency/CountryOfResidency | /Demographics/CitizenshipStatus | /EnglishProficiency/Code | /Language/Code | /Language/LanguageType | /DwellingArrangement/Code | EmployeeCredential/Race | EmployeeCredential/Hispanic | /Certification/AreaAuthorized | EmployeeCredential/Salary | EmployeeCredential/Status | EmployeeCredential/Leave | EmployeeCredential/Education | EmployeeCredential/TeachingCredentialType | EmployeeCredential/TerminationCode | /BackgroundCheck/Type | /JobFunction/Code | EmployeeCredit/Earned | /OtherIdList/OtherId | /EmailList/Email | EmployeePicture/PictureSource | EmployeeRecertification/ActivityType | EmployeeRecertification/Earned | /PayRate/Amount | EmploymentRecord/FullTimeStatus | /Type/Facility | /ReadingData/Measurement | /ReadingData/EnergyUnits | /ReadingList/Reading | /AnnualItem/AccountType | /AnnualItem/AccountTypeDetail | /AnnualItem/FundType | /AnnualItem/ExpenditureArea | /AnnualItem/SpecialAmountType | /AnnualItem/GLAmountType | /BudgetAccount/AccountClass | FinancialClass/ClassType | /Amounts/Amount | FinancialIncomeStatement/Program | FinancialTransaction/Program | /ElectronicIdList/ElectronicId | FoodserviceItemPortion/ItemPortionType | FoodserviceItemSales/Program | /ItemQuantity/MealType | /ItemQuantity/Cost | FoodserviceMealPrices/Program | /Price/Value | /Price/MealType | FoodserviceMenuPlan/Program | /MenuPlanQuantities/MenuPlanQuantity | FoodserviceMilkSales/Program | /SaleQuantity/ChargeToChild | /PurchaseQuantity/MealType | FoodserviceReimbursementRates/Program | FoodserviceSales/Program | /SalesAmounts/SalesAmount | FoodserviceStaffEnrollmentCount/Program | /Count/MealType | /Count/Amount | /Count/Tax | FoodserviceStaffMealCounts/Program | FoodserviceStudentEnrollmentCount/Program | FoodserviceStudentMealCounts/Program | FoodserviceTransaction/Program | /TransactionTypes/TransactionType | FoodserviceTransaction/Amount | FoodserviceTransaction/Tax | FoodserviceTransaction/Voided | GradingAssignment/DetailedDescription | IdMAuthentication/IdentityProviderType | /EducationAgencyType/Code | /LEAContact/PublishInDirectory | /AddressRefIdList/AddressRefId | /IdentificationInfoList/IdentificationInfo | LEAInfo/OperationalStatus | /Contact/Email | LearningResource/Location | /AssociatedObjects/AssociatedObject | LearningStandardAssociation/LearningStandardRefId | LearningStandardAssociation/Creator | LearningStandardDocument/Source | LearningStandardDocument/DocumentStatus | /StandardSettingBody/Country | /StandardSettingBody/StateProvince | /RelatedLearningStandardItems/LearningStandardItemRefId | Lesson/Duration | /Author/Email | /ItemInfo/ElectronicId | /ItemInfo/Price | /FineInfo/Amount | LibraryPatronStatus/FineAmount | LibraryPatronStatus/RefundAmount | LocationInfo/ParentLocationInfo | Payment/ReceivedAmount | PersonRoleAssociation/AssociatedRoleRefId | PersonRoleAssociation/Creator | ProfessionalDevelopmentActivities/Stipend | ProfessionalDevelopmentRegistration/RegistrationStatus | ProfessionalDevelopmentRegistration/PaidAmount | ProfessionalDevelopmentRegistration/Stipend | Purchasing/FormType | /PurchasingItem/UnitCost | /ExpenseAccount/Amount | /Measurement/FrequencyofMeasure | ReportManifest/ReceivingAuthority | ReportManifest/ReportDefinitionSource | /ReportFormatList/ReportFormat | /Intervention/InterventionType | /Intervention/InterventionDelivery | /FrequencyTime/Duration | /SEAContact/PublishInDirectory | SEAInfo/OperationalStatus | /EDENInfo/FIPSStateCode | /ReportSubmitterInfo/SIF_RefId | /InstructionalLevel/Code | SchoolCourseInfo/CourseCredits | SchoolCourseInfo/CoreAcademicCourse | SchoolCourseInfo/GraduationRequirement | /SCEDCode/CourseDescription | /SCEDCode/CourseLevel | SchoolCourseInfo/DualCredit | SchoolCourseInfo/CTEConcentrator | SchoolInfo/OtherLEA | SchoolInfo/SchoolType | /SchoolFocusList/SchoolFocus | /SchoolContact/PublishInDirectory | SchoolInfo/SessionType | SchoolInfo/Title1Status | SchoolInfo/OperationalStatus | /CorrelationType/Code | /CorrelationSectionList/CorrelationSection | /MediumOfInstruction/Code | /LanguageOfInstruction/Code | /LocationOfInstruction/Code | SectionInfo/SummerSchool | /SchoolCourseInfoOverride/CourseCredits | SectionInfo/CountForAttendance | StaffAssignment/PrimaryAssignment | /TeachingAssignment/Code | StaffAssignment/ItinerantTeacher | StaffSectionAssignment/TeacherOfRecord | /Roles/Role | /EntryType/Code | /ExitStatus/Code | /ExitType/Code | /StudentLEARelationship/MembershipType | /ResidencyStatus/Code | /StudentSchoolRelationship/MembershipType | /StudentSchoolRelationship/NonResidentAttendReason | /TermSpan/Code | /SchoolCourseInfoData/GraduationRequirement | /GradeLevelWhenTaken/Code | /MarkingPeriod/CreditType | /AcademicPerformanceSummary/AcademicTrack | /AcademicFocus/Code | /AcademicSubject/Code | /StudentGradeLevelWhenAssessed/Code | /Assessment/TestScoreType | /Requirement/Status | /ActivityAward/InvolvementCode | /ActivityAward/HonorsInformationCode | /ActivityAward/DiplomaCredentialHonorsCode | /StudentActivityType/Code | StudentActivityInfo/CurricularStatus | /RecognitionList/Recognition | StudentAttendanceSummary/Resident | /Relationship/Code | StudentContact/EmployerType | StudentContact/EducationalLevel | /ContactFlags/ParentLegalGuardian | /ContactFlags/PickupRights | /ContactFlags/LivesWith | /ContactFlags/AccessToRecords | /ContactFlags/EmergencyContact | /ContactFlags/HasCustody | /ContactFlags/DisciplinaryContact | /ContactFlags/PrimaryCareProvider | /ContactFlags/Other | StudentContactPersonal/EmployerType | StudentContactPersonal/EducationLevel | StudentContactPersonal/OptOutEmail | /DemographicsData/Gender | /DemographicsData/HispanicLatino | /DemographicsData/CountryOfBirth | /StudentPersonalData/IDEA | /StudentPersonalData/Migrant | /StudentPersonalData/Title1 | /StudentPersonalData/GiftedTalented | /StudentPersonalData/EconomicDisadvantage | /StudentPersonalData/ELL | /StudentPersonalData/Homeless | /StudentPersonalData/Section504 | /StudentPersonalData/VocationalConcentrator | /StudentPersonalData/Immigrant | /StudentPersonalData/NeglectedDelinquent | StudentLEARelationship/MembershipType | StudentLEARelationship/NonResidentAttendReason | trueStudentLocator/RequestingAgencyId | /Contact/EducationalLevel | trueStudentLocator/OtherId | /ProgramFundingSource/Code | StudentParticipation/ManagingPublicAgency | StudentParticipation/ManagingSchool | /PartCTransitionMeetingNotHeldReason/Code | /PartCTransitionMeetingOutcome/Code | /ReferralSource/Code | /ProgramStatus/Code | /ExceptionalityCategory/Code | /ProgramPlanType/Code | /LeastRestrictiveEnvironment/Code | /ProgramAvailability/Code | /ProgramExitReason/Code | StudentParticipation/ProjectedExitReason | StudentParticipation/PlannedAssessmentParticipation | StudentParticipation/TransitionPlanning | StudentPeriodAttendance/AttendanceCode | /AlertMessages/AlertMessage | /MedicalAlertMessages/MedicalAlertMessage | StudentPersonal/AcceptableUsePolicy | StudentPersonal/IDEA | StudentPersonal/Migrant | StudentPersonal/Title1 | StudentPersonal/GiftedTalented | StudentPersonal/EconomicDisadvantage | StudentPersonal/ELL | StudentPersonal/Homeless | StudentPersonal/Section504 | StudentPersonal/VocationalConcentrator | StudentPersonal/Immigrant | StudentPersonal/NeglectedDelinquent | StudentPicture/PictureSource | StudentPicture/OKToPublish | /Service/Code | StudentPlacement/ServiceCategory | /ServiceFundingSource/Code | StudentPlacement/ServicingPublicAgency | StudentPlacement/ServicingSchool | StudentPlacement/SchoolWhereServiceDelivered | /ServiceProviderType/Code | /ServiceSetting/Code | /WhenServiceProvided/Code | /FrequencyTime/Code | StudentPlacement/DirectTime | StudentPlacement/IndirectTime | StudentPlacement/TotalServiceDuration | /Item/ResponseStatus | StudentSchoolEnrollment/Homeroom | StudentSchoolEnrollment/Advisor | StudentSchoolEnrollment/Counselor | StudentSchoolEnrollment/Calendar | StudentSchoolEnrollment/RecordClosureReason | /PromotionInfo/PromotionStatus | /Promotion/Code | /Nonpromotion/Code | StudentSchoolEnrollment/FTPTStatus | StudentSchoolEnrollment/NonResidentAttendReason | StudentSectionEnrollment/CreditsAttempted | StudentSectionEnrollment/DualCredit | StudentSectionEnrollment/CTEConcentrator | StudentSnapshot/HispanicLatino | StudentSnapshot/Gender | StudentSnapshot/GraduationAward | StudentSnapshot/GraduationOnTime | /HomeEnrollment/Status | /HomeEnrollment/Homeroom | /HomeEnrollment/FullYearEnrollment | StudentSnapshot/IDEA | StudentSnapshot/Migrant | StudentSnapshot/Title1 | StudentSnapshot/GiftedTalented | StudentSnapshot/EconomicDisadvantage | StudentSnapshot/ELL | StudentSnapshot/Homeless | StudentSnapshot/Section504 | StudentSnapshot/VocationalConcentrator | StudentSnapshot/Immigrant | StudentSnapshot/NeglectedDelinquent | StudentSnapshot/FreeAndReducedStatus | /StudentParticipationData/PlannedAssessmentParticipation | /StudentParticipationData/ManagingPublicAgency | /StudentParticipationData/ManagingSchool | /StudentParticipationData/GiftedEligibilityCriteria | /StudentPlacementData/ServiceCategory | /StudentPlacementData/ServicingPublicAgency | /StudentPlacementData/ServicingSchool | /StudentPlacementData/SchoolWhereServiceDelivered | StudentSpecialEducationSummary/PrimaryDisabilityCode | /NeglectedOrDelinquentParticipation/Type | StudentTransportInfo/Eligibility | StudentTransportInfo/HomeToSchoolDistance | StudentTransportInfo/WalkToStopDistance | StudentTransportInfo/StopToSchoolDistance | StudentTransportInfo/HomeBusRouteDetail | /TransferPoint/EmbarkBusRouteDetail | /TransferPoint/DisembarkBusRouteDetail | StudentTransportInfo/SchoolBusRouteDetail | StudentTransportInfo/StateAidQualification | StudentTransportInfo/TransportationStatus | StudentTransportInfo/PublicExpense | TermInfo/MarkingTerm | TermInfo/SchedulingTerm | TermInfo/AttendanceTerm | TestAccommodation/TestType | TestAccommodation/AuthorizedActual | /AccommodationCategory/Code | UserOrganizationAssociation/PersonRefId | UserOrganizationAssociation/OrganizationRefId | VendorInfo/FederalTaxId | W4/MaritalStatusRate | W4/StateProvince" mode="detect">
    <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="obj-content" />
    <xsl:if test="count(following-sibling::*) &gt; 0">, </xsl:if>
  </xsl:template>

  <!-- list -->
  <xsl:template match="/FundingSourceList/FundingSource | /sessions/sessionList | /otherNames/name | /otherIds/otherId | /otherPhoneNumbers/phoneNumber | /otherEmails/email | /relationships/relationship | /applicableEducationLevels/applicableEducationLevel | /transferPermissionList/transmitPermission | /background/consentToEvaluation | /iepEligibility/evaluationResultList | /evaluationResultList/evaluationResult | /ideaDisability/disabilityCodeList | /ideaDisability/analysis | /iepEligibility/eligibilityParticipantReportList | /participantReport/role | /iepPlan/effectivePeriod | /iepPlan/enrollmentGradeLevel | /presentLevelPerformance/personal | /personal/concerns | /personal/evaluation | /evaluation/needsList | /evaluation/performance | /performance/testResultList | /evaluation/personalGoalsList | /personal/intention | /intention/desiredOutcomeList | /presentLevelPerformance/academic | /academic/deficitList | /deficit/academicSubject | /deficit/accommodation | /academic/summary | /accommodationList/accommodation | /presentLevelPerformance/functional | /functional/disabilityList | /disability/disabilityCodeList | /disability/accommodation | /functional/summary | /consequenceOfDisability/specialCategoryList | /annualGoalsList/annualGoal | /annualGoal/goalType | /annualGoal/measurableObjectiveList | /measurableObjective/facilitatorList | /measurableObjective/measurement | /criterion/metric | /metric/trialCountEvaluation | /annualGoal/independentActionsList | /annualGoal/servicesList | /service/serviceProvider | /service/frequency | /frequency/cycle | /frequency/duration | /annualGoal/coursesList | /annualGoal/progressReportList | /progressReport/measurement | /measurement/dataValuesList | /iepPlan/accommodationsList | /accommodation/accommodation | /accommodation/applicabilityList | /iepPlan/standardizedAssessmentResultList | /standardizedAssessmentResultList/standardizedAssessmentResult | /standardizedAssessmentResult/standardsReference | /standardizedAssessmentResult/accommodationList | /parentGuardianAuthorization/rejectedPlanElements | /rejectedPlanElements/rejectedDetailList | /iepPlan/amendmentList | /amendmentList/amendment | /amendment/changeList | /changeList/change | /meetingTimes/meetingTime | /students/studentReference | /otherStaffs/otherStaff | /gradeLevels/gradeLevel | /otherAssignments/staffPersonAssignment | /otherAddresses/name | /races/race | /otherEnrollments/enrollment | /studentContacts/contactPersonRefId | /studentContacts/xContact | /languages/language | /leaList/referenceLea | /contactList/referenceContactPerson | /staffList/referenceStaffPerson | /organizationList/referenceOrganization | /TimeElements/TimeElement | /SpanGaps/SpanGap | /Creators/Creator | /ModificationHistory/Modified | /RightsElements/RightsElement | /FeesForUse/FeeForUse | /MediaTypes/MediaType | /GradeLevels/GradeLevel | /OtherCodeList/OtherCode | /SubjectAreas/SubjectArea | /InterestLevels/InterestLevel | /LearningStandardItems/LearningStandardItemRefId | /BloomsTaxonomyLevels/BloomsTaxonomyLevel | /MultipleIntelligences/MultipleIntelligence | /InstructionalStrategies/InstructionalStrategy | /LearningObjectives/LearningObjective | /ResourceTypes/ResourceType | /SIF_ExtendedElements/SIF_ExtendedElement | /TechnicalRequirements/TechnicalRequirement | /SoftwareRequirementList/SoftwareRequirement | /EssentialMaterials/EssentialMaterial | /LearningStandards/LearningStandardItemRefId | /Prerequisites/Prerequisite | /Students/StudentPersonalRefId | /SourceObjects/SourceObject | /LearningResources/LearningResourceRefId | /Characteristics/AggregateCharacteristicInfoRefId | /ExclusionRules/ExclusionRule | /AssessmentDescriptors/AssessmentDescriptor | /SpecialConditions/SpecialCondition | /FormNumbers/FormNumber | /AssessmentSubTestRefIds/AssessmentSubTestRefId | /ResponseChoices/Choice | /PerformanceLevels/PerformanceLevel | /StudentSpecialConditions/StudentSpecialCondition | /RaceList/Race | /LearningStandardItemRefIds/LearningStandardItemRefId | /PasswordList/Password | /TimetableDayList/TimetableDay | /TimetablePeriodList/TimetablePeriod | /BellPeriodList/BellPeriod | /EquipmentList/Equipment | /TelemetryList/Telemetry | /BusStaffList/BusStaff | /Students/Student | /BellScheduleDayList/BellScheduleDay | /LearningStandards/Document | /StatementCodes/StatementCode | /CurriculumHierarchyList/CurriculumHierarchy | /Titles/Title | /PredecessorObjects/CurriculumStructureRefId | /ComponentObjects/ComponentObject | /RelatedToList/RelatedTo | /WeaponTypeList/WeaponType | /OffenderList/Offender | /ActionList/Action | /VictimList/Victim | /IncidentActionList/IncidentAction | /CountriesOfCitizenship/CountryOfCitizenship | /CountriesOfResidency/CountryOfResidency | /LanguageList/Language | /Certifications/Certification | EmployeeCredential/TeachingCredentialType | /BackgroundChecks/BackgroundCheck | /Assignments/Assignment | /OtherIdList/OtherId | /AddressList/Address | /PhoneNumberList/PhoneNumber | /EmailList/Email | /PayRates/PayRate | /TagList/Tag | /ReadingDataList/ReadingData | /ReadingList/Reading | /AnnualItems/AnnualItem | /BudgetAccounts/BudgetAccount | /Amounts/Amount | /ElectronicIdList/ElectronicId | /ItemQuantities/ItemQuantity | /Prices/Price | /MenuPlanQuantities/MenuPlanQuantity | /SaleQuantities/SaleQuantity | /PurchaseQuantities/PurchaseQuantity | /Agencies/Agency | /Rates/Rate | /SalesAmounts/SalesAmount | /Counts/Count | /TransactionTypes/TransactionType | /TransactionPayMethods/TransactionPayMethod | /FunctionList/Function | /IdentityProviderList/IdentityProvider | /Measurements/Measurement | /ResponseChoicePattern/Choice | /LEAContactList/LEAContact | /AddressRefIdList/AddressRefId | /IdentificationInfoList/IdentificationInfo | /Contacts/Contact | /Approvals/Approval | /Evaluations/Evaluation | /Components/Component | /Strategies/Strategy | /AssociatedObjects/AssociatedObject | /TargetObjects/TargetObject | /Organizations/Organization | /Authors/Author | /RelatedLearningStandards/LearningStandardDocumentRefId | /PredecessorItems/LearningStandardItemRefId | /Statements/Statement | /AlternateIdentificationCodes/AlternateIdentificationCode | /RelatedLearningStandardItems/LearningStandardItemRefId | /CurriculumStructures/CurriculumStructureRefId | /SupportingActivities/ActivityRefId | /LessonSources/LessonSource | /LessonSource/Author | /TransactionList/Transaction | /FineInfoList/FineInfo | /HoldInfoList/HoldInfo | /MessageList/Message | /OtherLEAs/LEAInfoRefId | /Letter/ValidMark | /PurchasingItems/PurchasingItem | /ExpenseAccounts/ExpenseAccount | /PerformanceIndicators/PerformanceIndicator | /Baselines/Baseline | /Targets/Target | /Results/Result | /ReportFormatList/ReportFormat | /InterventionProviderNames/InterventionProviderName | /Interventions/Intervention | /StaffList/StaffPersonalRefId | /SEAContactList/SEAContact | /SubjectAreaList/SubjectArea | /SchoolFocusList/SchoolFocus | /SchoolContactList/SchoolContact | /CorrelationSectionList/CorrelationSection | /ScheduleInfoList/ScheduleInfo | /TeacherList/StaffPersonalRefId | /SectionRoomList/RoomInfoRefId | /MeetingTimeList/MeetingTime | /TermMarkLists/MarkInfoList | /MarkInfoList/MarkInfoRefId | /EvaluationParts/EvaluationPart | /OtherNames/Name | /Roles/Role | /SchoolAttendanceHistory/SchoolAttended | /MarkingSystems/MarkValueInfoData | /EnrollmentHistory/StudentSchoolEnrollmentData | /Courses/Course | /CourseHistory/Term | /MarkingPeriods/MarkingPeriod | /AcademicPerformanceHistory/TermPerformance | /AcademicFoci/AcademicFocus | /AcademicSubjects/AcademicSubject | /AssessmentPerformanceHistory/Assessment | /AdditionalGraduationRequirementPerformanceHistory/Requirement | /ActivityAwardHistory/ActivityAward | /RecognitionList/Recognition | trueStudentLocator/RequestingAgencyId | trueStudentLocator/Name | trueStudentLocator/Address | /HistoricalMealStatus/MealStatus | /ProgramFundingSources/ProgramFundingSource | /PartCTransitionMeetingNotHeldReasons/PartCTransitionMeetingNotHeldReason | /PartCTransitionMeetingOutcomes/PartCTransitionMeetingOutcome | /ExceptionalityCategories/ExceptionalityCategory | /AdditionalProgramAvailabilityList/ProgramAvailability | /AlertMessages/AlertMessage | /MedicalAlertMessages/MedicalAlertMessage | /ServiceFundingSources/ServiceFundingSource | /OtherRecords/StudentRecordPackageRefId | /Items/Item | /Scores/Score | /ScheduleInfoOverrideList/ScheduleInfoOverride | /MarkList/Mark | /StudentParticipationList/StudentParticipationData | /StudentPlacementList/StudentPlacementData | /NeglectedOrDelinquentParticipationList/NeglectedOrDelinquentParticipation | /TransferPoints/TransferPoint | /StudentProgramAccommodations/StudentProgramAccommodation | /Accommodations/Accommodation" mode="detect">
  <xsl:if test="count(preceding-sibling::*) = 0">
      <xsl:text>"</xsl:text><xsl:value-of select="name()"/><xsl:text>" : [</xsl:text>
    </xsl:if>
    <xsl:choose>
      <xsl:when test="count(./child::*) > 0 or count(@*) > 0">
        <xsl:apply-templates select="." mode="obj-content" />
      </xsl:when>
      <xsl:when test="count(./child::*) = 0">
        <xsl:apply-templates select="." mode="value"/>
      </xsl:when>
    </xsl:choose>
    <xsl:if test="count(following-sibling::*) &gt; 0">, </xsl:if>
    <xsl:if test="count(following-sibling::*) = 0"><xsl:text>]</xsl:text></xsl:if>
  </xsl:template>

  <xsl:template match="*" mode="obj-content">
    <xsl:text>{</xsl:text>
    <xsl:apply-templates select="@*" mode="attr" />
    <xsl:if test="count(@*) &gt; 0 and (count(child::*) &gt; 0 or text())">, </xsl:if>
    <xsl:apply-templates select="./*" mode="detect" />
    <xsl:if test="count(child::*) = 0 and text() and not(@*)">
      <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="value"/>
    </xsl:if>
    <xsl:if test="count(child::*) = 0 and text() and @*">
      <xsl:text>"value" : </xsl:text><xsl:apply-templates select="." mode="value"/>
    </xsl:if>
    <xsl:text>}</xsl:text>
    <xsl:if test="position() &lt; last()">, </xsl:if>
  </xsl:template>

  <!-- simple content with attribute -->
  <xsl:template match="Address/AddressType | /LocalId/IdType | Address/Subregion | Address/StateProvince | Address/Country | StudentProgramAssociation/EntryType | StudentProgramAssociation/YearGroup | StudentProgramAssociation/ExitStatus | StudentProgramAssociation/ExitType | StudentProgramAssociation/PlacementType | /ManagingSchoolLocalId/IdType | /FeeForUse/PerUseCharge | /GradeLevel/Code | /OtherCodeList/OtherCode | /SubjectArea/Code | /InterestLevel/Code | /BloomsTaxonomyLevels/BloomsTaxonomyLevel | /MultipleIntelligences/MultipleIntelligence | /InstructionalStrategies/InstructionalStrategy | /ResourceTypes/ResourceType | /SIF_ExtendedElements/SIF_ExtendedElement | /SourceObjects/SourceObject | /ActivityTime/Duration | /Address/StateProvince | /Address/Country | AggregateStatisticFact/Excluded | AggregateStatisticInfo/CalculationRule | /ExclusionRules/ExclusionRule | /Location/LocationRefId | AggregateStatisticInfo/Measure | /AssessmentDescriptors/AssessmentDescriptor | /SpecialConditions/SpecialCondition | AssessmentForm/AssessmentType | /Stimulus/XMLData | /Stimulus/TextData | /Stimulus/BinaryData | /Stem/XMLData | /Stem/TextData | /Stem/BinaryData | /ChoiceContent/XMLData | /ChoiceContent/TextData | /ChoiceContent/BinaryData | AssessmentPackage/XMLData | /StudentSpecialConditions/StudentSpecialCondition | /StudentGradeLevel/Code | /AssessmentGradeLevel/Code | /Race/Code | /AssessmentStudentSnapshot/HispanicLatino | /AssessmentStudentSnapshot/Gender | /AssessmentStudentSnapshot/Title1 | /AssessmentStudentSnapshot/ELL | /AssignmentTime/Duration | AttendanceCodeInfo/AttendanceType | AttendanceCodeInfo/AttendanceStatus | AttendanceCodeInfo/UsedForDailyAttendance | AttendanceCodeInfo/UsedForPeriodAttendance | /AuthenticationInfo/System | /PasswordList/Password | /BellPeriod/RegularSchoolPeriod | /BellPeriod/UseInAttendanceCalculations | Billing/BilledEntity | Billing/BilledAmount | /BusDriver/Status | /BusStaff/Status | BusPositionInfo/Odometer | BusPositionInfo/Speedometer | /Student/Status | BusRouteInfo/RouteType | BusRouteInfo/RouteDistanceLoaded | BusRouteInfo/RouteDistanceTotal | /CalendarDateType/Code | /StudentAttendance/CountsTowardAttendance | /TeacherAttendance/CountsTowardAttendance | /AdministratorAttendance/CountsTowardAttendance | /ContentObject/SourceObject | /ContentObject/Location | ContentCatalog/LanguageCode | /StandardsSettingBody/Country | /StandardsSettingBody/StateProvince | ContentCatalog/InstructionalLevel | ContentCatalog/Duration | ContentCatalog/Cost | /ComponentObjects/ComponentObject | DisciplineIncident/AgencyReporting | DisciplineIncident/IncidentTime | DisciplineIncident/IncidentLocation | DisciplineIncident/IncidentLocationRefId | /IncidentReporter/SIF_RefId | /RelatedToList/RelatedTo | /WeaponTypeList/WeaponType | /IncidentCategory/Code | /Offender/SIF_RefId | /Offender/Injury | /ManifestationDetermination/MeetingHeld | /ManifestationDetermination/DueToDisability | /Action/Code | /Action/ZeroTolerance | /Action/FullYearExpulsion | /Action/ShortenedExpulsion | /Action/PoliceNotification | /Action/Arrest | /Action/AlternativeEducation | /Victim/SIF_RefId | /Victim/Injury | /IncidentAction/ZeroTolerance | /IncidentAction/PoliceNotification | /IncidentAction/Arrest | EmployeeAssignment/PrimaryAssignment | /JobClassification/Code | /ProgramType/Code | /FundingSource/Code | EmployeeContract/BaseSalary | EmployeeContract/ContractTerm | /Demographics/HispanicLatino | /Demographics/Gender | /Demographics/BirthDateVerification | /Demographics/StateOfBirth | /Demographics/CountryOfBirth | /CountriesOfCitizenship/CountryOfCitizenship | /CountriesOfResidency/CountryOfResidency | /Demographics/CitizenshipStatus | /EnglishProficiency/Code | /Language/Code | /Language/LanguageType | /DwellingArrangement/Code | EmployeeCredential/Race | EmployeeCredential/Hispanic | /Certification/AreaAuthorized | EmployeeCredential/Salary | EmployeeCredential/Status | EmployeeCredential/Leave | EmployeeCredential/Education | EmployeeCredential/TeachingCredentialType | EmployeeCredential/TerminationCode | /BackgroundCheck/Type | /JobFunction/Code | EmployeeCredit/Earned | /OtherIdList/OtherId | /EmailList/Email | EmployeePicture/PictureSource | EmployeeRecertification/ActivityType | EmployeeRecertification/Earned | /PayRate/Amount | EmploymentRecord/FullTimeStatus | /Type/Facility | /ReadingData/Measurement | /ReadingData/EnergyUnits | /ReadingList/Reading | /AnnualItem/AccountType | /AnnualItem/AccountTypeDetail | /AnnualItem/FundType | /AnnualItem/ExpenditureArea | /AnnualItem/SpecialAmountType | /AnnualItem/GLAmountType | /BudgetAccount/AccountClass | FinancialClass/ClassType | /Amounts/Amount | FinancialIncomeStatement/Program | FinancialTransaction/Program | /ElectronicIdList/ElectronicId | FoodserviceItemPortion/ItemPortionType | FoodserviceItemSales/Program | /ItemQuantity/MealType | /ItemQuantity/Cost | FoodserviceMealPrices/Program | /Price/Value | /Price/MealType | FoodserviceMenuPlan/Program | /MenuPlanQuantities/MenuPlanQuantity | FoodserviceMilkSales/Program | /SaleQuantity/ChargeToChild | /PurchaseQuantity/MealType | FoodserviceReimbursementRates/Program | FoodserviceSales/Program | /SalesAmounts/SalesAmount | FoodserviceStaffEnrollmentCount/Program | /Count/MealType | /Count/Amount | /Count/Tax | FoodserviceStaffMealCounts/Program | FoodserviceStudentEnrollmentCount/Program | FoodserviceStudentMealCounts/Program | FoodserviceTransaction/Program | /TransactionTypes/TransactionType | FoodserviceTransaction/Amount | FoodserviceTransaction/Tax | FoodserviceTransaction/Voided | GradingAssignment/DetailedDescription | IdMAuthentication/IdentityProviderType | /EducationAgencyType/Code | /LEAContact/PublishInDirectory | /AddressRefIdList/AddressRefId | /IdentificationInfoList/IdentificationInfo | LEAInfo/OperationalStatus | /Contact/Email | LearningResource/Location | /AssociatedObjects/AssociatedObject | LearningStandardAssociation/LearningStandardRefId | LearningStandardAssociation/Creator | LearningStandardDocument/Source | LearningStandardDocument/DocumentStatus | /StandardSettingBody/Country | /StandardSettingBody/StateProvince | /RelatedLearningStandardItems/LearningStandardItemRefId | Lesson/Duration | /Author/Email | /ItemInfo/ElectronicId | /ItemInfo/Price | /FineInfo/Amount | LibraryPatronStatus/FineAmount | LibraryPatronStatus/RefundAmount | LocationInfo/ParentLocationInfo | Payment/ReceivedAmount | PersonRoleAssociation/AssociatedRoleRefId | PersonRoleAssociation/Creator | ProfessionalDevelopmentActivities/Stipend | ProfessionalDevelopmentRegistration/RegistrationStatus | ProfessionalDevelopmentRegistration/PaidAmount | ProfessionalDevelopmentRegistration/Stipend | Purchasing/FormType | /PurchasingItem/UnitCost | /ExpenseAccount/Amount | /Measurement/FrequencyofMeasure | ReportManifest/ReceivingAuthority | ReportManifest/ReportDefinitionSource | /ReportFormatList/ReportFormat | /Intervention/InterventionType | /Intervention/InterventionDelivery | /FrequencyTime/Duration | /SEAContact/PublishInDirectory | SEAInfo/OperationalStatus | /EDENInfo/FIPSStateCode | /ReportSubmitterInfo/SIF_RefId | /InstructionalLevel/Code | SchoolCourseInfo/CourseCredits | SchoolCourseInfo/CoreAcademicCourse | SchoolCourseInfo/GraduationRequirement | /SCEDCode/CourseDescription | /SCEDCode/CourseLevel | SchoolCourseInfo/DualCredit | SchoolCourseInfo/CTEConcentrator | SchoolInfo/OtherLEA | SchoolInfo/SchoolType | /SchoolFocusList/SchoolFocus | /SchoolContact/PublishInDirectory | SchoolInfo/SessionType | SchoolInfo/Title1Status | SchoolInfo/OperationalStatus | /CorrelationType/Code | /CorrelationSectionList/CorrelationSection | /MediumOfInstruction/Code | /LanguageOfInstruction/Code | /LocationOfInstruction/Code | SectionInfo/SummerSchool | /SchoolCourseInfoOverride/CourseCredits | SectionInfo/CountForAttendance | StaffAssignment/PrimaryAssignment | /TeachingAssignment/Code | StaffAssignment/ItinerantTeacher | StaffSectionAssignment/TeacherOfRecord | /Roles/Role | /EntryType/Code | /ExitStatus/Code | /ExitType/Code | /StudentLEARelationship/MembershipType | /ResidencyStatus/Code | /StudentSchoolRelationship/MembershipType | /StudentSchoolRelationship/NonResidentAttendReason | /TermSpan/Code | /SchoolCourseInfoData/GraduationRequirement | /GradeLevelWhenTaken/Code | /MarkingPeriod/CreditType | /AcademicPerformanceSummary/AcademicTrack | /AcademicFocus/Code | /AcademicSubject/Code | /StudentGradeLevelWhenAssessed/Code | /Assessment/TestScoreType | /Requirement/Status | /ActivityAward/InvolvementCode | /ActivityAward/HonorsInformationCode | /ActivityAward/DiplomaCredentialHonorsCode | /StudentActivityType/Code | StudentActivityInfo/CurricularStatus | /RecognitionList/Recognition | StudentAttendanceSummary/Resident | /Relationship/Code | StudentContact/EmployerType | StudentContact/EducationalLevel | /ContactFlags/ParentLegalGuardian | /ContactFlags/PickupRights | /ContactFlags/LivesWith | /ContactFlags/AccessToRecords | /ContactFlags/EmergencyContact | /ContactFlags/HasCustody | /ContactFlags/DisciplinaryContact | /ContactFlags/PrimaryCareProvider | /ContactFlags/Other | StudentContactPersonal/EmployerType | StudentContactPersonal/EducationLevel | StudentContactPersonal/OptOutEmail | /DemographicsData/Gender | /DemographicsData/HispanicLatino | /DemographicsData/CountryOfBirth | /StudentPersonalData/IDEA | /StudentPersonalData/Migrant | /StudentPersonalData/Title1 | /StudentPersonalData/GiftedTalented | /StudentPersonalData/EconomicDisadvantage | /StudentPersonalData/ELL | /StudentPersonalData/Homeless | /StudentPersonalData/Section504 | /StudentPersonalData/VocationalConcentrator | /StudentPersonalData/Immigrant | /StudentPersonalData/NeglectedDelinquent | StudentLEARelationship/MembershipType | StudentLEARelationship/NonResidentAttendReason | trueStudentLocator/RequestingAgencyId | /Contact/EducationalLevel | trueStudentLocator/OtherId | /ProgramFundingSource/Code | StudentParticipation/ManagingPublicAgency | StudentParticipation/ManagingSchool | /PartCTransitionMeetingNotHeldReason/Code | /PartCTransitionMeetingOutcome/Code | /ReferralSource/Code | /ProgramStatus/Code | /ExceptionalityCategory/Code | /ProgramPlanType/Code | /LeastRestrictiveEnvironment/Code | /ProgramAvailability/Code | /ProgramExitReason/Code | StudentParticipation/ProjectedExitReason | StudentParticipation/PlannedAssessmentParticipation | StudentParticipation/TransitionPlanning | StudentPeriodAttendance/AttendanceCode | /AlertMessages/AlertMessage | /MedicalAlertMessages/MedicalAlertMessage | StudentPersonal/AcceptableUsePolicy | StudentPersonal/IDEA | StudentPersonal/Migrant | StudentPersonal/Title1 | StudentPersonal/GiftedTalented | StudentPersonal/EconomicDisadvantage | StudentPersonal/ELL | StudentPersonal/Homeless | StudentPersonal/Section504 | StudentPersonal/VocationalConcentrator | StudentPersonal/Immigrant | StudentPersonal/NeglectedDelinquent | StudentPicture/PictureSource | StudentPicture/OKToPublish | /Service/Code | StudentPlacement/ServiceCategory | /ServiceFundingSource/Code | StudentPlacement/ServicingPublicAgency | StudentPlacement/ServicingSchool | StudentPlacement/SchoolWhereServiceDelivered | /ServiceProviderType/Code | /ServiceSetting/Code | /WhenServiceProvided/Code | /FrequencyTime/Code | StudentPlacement/DirectTime | StudentPlacement/IndirectTime | StudentPlacement/TotalServiceDuration | /Item/ResponseStatus | StudentSchoolEnrollment/Homeroom | StudentSchoolEnrollment/Advisor | StudentSchoolEnrollment/Counselor | StudentSchoolEnrollment/Calendar | StudentSchoolEnrollment/RecordClosureReason | /PromotionInfo/PromotionStatus | /Promotion/Code | /Nonpromotion/Code | StudentSchoolEnrollment/FTPTStatus | StudentSchoolEnrollment/NonResidentAttendReason | StudentSectionEnrollment/CreditsAttempted | StudentSectionEnrollment/DualCredit | StudentSectionEnrollment/CTEConcentrator | StudentSnapshot/HispanicLatino | StudentSnapshot/Gender | StudentSnapshot/GraduationAward | StudentSnapshot/GraduationOnTime | /HomeEnrollment/Status | /HomeEnrollment/Homeroom | /HomeEnrollment/FullYearEnrollment | StudentSnapshot/IDEA | StudentSnapshot/Migrant | StudentSnapshot/Title1 | StudentSnapshot/GiftedTalented | StudentSnapshot/EconomicDisadvantage | StudentSnapshot/ELL | StudentSnapshot/Homeless | StudentSnapshot/Section504 | StudentSnapshot/VocationalConcentrator | StudentSnapshot/Immigrant | StudentSnapshot/NeglectedDelinquent | StudentSnapshot/FreeAndReducedStatus | /StudentParticipationData/PlannedAssessmentParticipation | /StudentParticipationData/ManagingPublicAgency | /StudentParticipationData/ManagingSchool | /StudentParticipationData/GiftedEligibilityCriteria | /StudentPlacementData/ServiceCategory | /StudentPlacementData/ServicingPublicAgency | /StudentPlacementData/ServicingSchool | /StudentPlacementData/SchoolWhereServiceDelivered | StudentSpecialEducationSummary/PrimaryDisabilityCode | /NeglectedOrDelinquentParticipation/Type | StudentTransportInfo/Eligibility | StudentTransportInfo/HomeToSchoolDistance | StudentTransportInfo/WalkToStopDistance | StudentTransportInfo/StopToSchoolDistance | StudentTransportInfo/HomeBusRouteDetail | /TransferPoint/EmbarkBusRouteDetail | /TransferPoint/DisembarkBusRouteDetail | StudentTransportInfo/SchoolBusRouteDetail | StudentTransportInfo/StateAidQualification | StudentTransportInfo/TransportationStatus | StudentTransportInfo/PublicExpense | TermInfo/MarkingTerm | TermInfo/SchedulingTerm | TermInfo/AttendanceTerm | TestAccommodation/TestType | TestAccommodation/AuthorizedActual | /AccommodationCategory/Code | UserOrganizationAssociation/PersonRefId | UserOrganizationAssociation/OrganizationRefId | VendorInfo/FederalTaxId | W4/MaritalStatusRate | W4/StateProvince" mode="obj-content">
    <xsl:text>{</xsl:text>
    <xsl:apply-templates select="@*" mode="attr" />
    <xsl:if test="count(@*) &gt; 0 and (count(child::*) &gt; 0 or text())">, </xsl:if>
    <xsl:apply-templates select="./*" mode="detect" />
    <xsl:if test="count(child::*) = 0 and text()">
      <xsl:text>"value" : </xsl:text><xsl:apply-templates select="." mode="value"/>
    </xsl:if>
    <xsl:text>}</xsl:text>
    <xsl:if test="position() &lt; last()">, </xsl:if>
  </xsl:template>

  <xsl:template match="@*" mode="attr">
    <xsl:text>"</xsl:text><xsl:value-of select="name()"/>" : <xsl:apply-templates select="." mode="attrvalue"/>
    <xsl:if test="position() &lt; last()">, </xsl:if>
  </xsl:template>

  <!-- https://github.com/bramstein/xsltjson/blob/master/conf/xml-to-jsonml.xsl -->
  <json:search name="string">
		<json:replace src="\" dst="\\"/>
		<json:replace src="&quot;" dst="\&quot;"/>
		<json:replace src="&#xA;" dst="\n"/>
		<json:replace src="&#xD;" dst="\r"/>
		<json:replace src="&#x9;" dst="\t"/>
		<json:replace src="\n" dst="\n"/>
		<json:replace src="\r" dst="\r"/>
		<json:replace src="\t" dst="\t"/>
  </json:search>

  <xsl:template name="replace-string">
		<xsl:param name="input"/>
		<xsl:param name="src"/>
		<xsl:param name="dst"/>
		<xsl:choose>
			<xsl:when test="contains($input, $src)">
				<xsl:value-of select="concat(substring-before($input, $src), $dst)"/>
				<xsl:call-template name="replace-string">
					<xsl:with-param name="input" select="substring-after($input, $src)"/>
					<xsl:with-param name="src" select="$src"/>
					<xsl:with-param name="dst" select="$dst"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$input"/>
			</xsl:otherwise>
		</xsl:choose>
  </xsl:template>

  <xsl:template name="encode">
		<xsl:param name="input"/>
		<xsl:param name="index">1</xsl:param>

		<xsl:variable name="text">
			<xsl:call-template name="replace-string">
				<xsl:with-param name="input" select="$input"/>
				<xsl:with-param name="src" select="document('')//json:search/json:replace[$index]/@src"/>
				<xsl:with-param name="dst" select="document('')//json:search/json:replace[$index]/@dst"/>
			</xsl:call-template>
		</xsl:variable>

		<xsl:choose>
			<xsl:when test="$index &lt; count(document('')//json:search/json:replace)">
				<xsl:call-template name="encode">
					<xsl:with-param name="input" select="$text"/>
					<xsl:with-param name="index" select="$index + 1"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$text"/>
			</xsl:otherwise>
		</xsl:choose>
  </xsl:template>

  <xsl:template name="encode-value">
                <xsl:param name="value"/>
                <xsl:choose>
                        <xsl:when test="normalize-space($value) != $value">
                                <xsl:call-template name="encode">
                                        <xsl:with-param name="input" select="$value"/>
                                </xsl:call-template>
                        </xsl:when>
                        <xsl:otherwise>
                                <xsl:value-of select="$value"/>
                        </xsl:otherwise>
                </xsl:choose>
  </xsl:template>

  <xsl:template match="node/@TEXT | text()" name="removeBreaks" priority="10">
    <xsl:call-template name="encode-value">
      <xsl:with-param name="value" select="." />
    </xsl:call-template>
  </xsl:template>

</xsl:stylesheet>
